import{usePageData as c,useSiteData as f}from"@vuepress/client";import{defineComponent as k,ref as v,shallowRef as w,onMounted as y,watch as l,h as o,nextTick as g}from"vue";import{isString as h,LoadingIcon as D}from"vuepress-shared/client";import"artalk/dist/Artalk.css";import"../styles/artalk.scss";import{u as M}from"../index-wG_My4pN.js";var A=k({name:"Artalk",props:{identifier:{type:String,required:!0},darkmode:Boolean},setup:a=>{const t=M(),d=c(),s=f(),i=v(!1),n=w();let e=null;const u=h(t.server),m=async()=>{const[{default:r}]=await Promise.all([import("artalk/dist/Artalk.es.js"),new Promise(p=>{setTimeout(()=>{p()},t.delay||800)})]);i.value=!0,await g();try{e=new r({useBackendConf:!1,site:s.value.title,pageTitle:d.value.title,...t,el:n.value,pageKey:a.identifier,darkMode:a.darkmode}),t.useBackendConf&&e.on("conf-loaded",()=>{e.setDarkMode(a.darkmode)})}catch{}};return y(()=>{l(()=>a.identifier,async()=>{try{e==null||e.destroy()}catch{}await m()},{immediate:!0}),l(()=>a.darkmode,r=>{e==null||e.setDarkMode(r)})}),()=>u?o("div",{class:"artalk-wrapper"},[i.value?null:o(D),o("div",{ref:n})]):null}});export{A as default};
//# sourceMappingURL=Artalk.js.map
